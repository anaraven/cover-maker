<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <!-- link rel="stylesheet" href="cover.css" -->
{% if page.font.url -%}
<link href="{{page.font.url}}" rel="stylesheet">
{% else %}
<link href="https://fonts.googleapis.com/css2?family={{page.font.family | replace: " ", "+" }}:wght@{{page.font.weight}}" rel="stylesheet">
{% endif -%}
<style>
body {
  /* box-sizing: border-box; */
}

#covers {
}

.face {
  /* height: 100%; */
  overflow: hidden;
  box-sizing: content-box;
  /* float: left; */
  /* border: grey 1px dashed; */
  width: {{ page.width }};
  height: {{ page.height }};
}

table {
  border-spacing: 0;
  border-collapse: collapse;
  padding: 0;
}

{% assign thickness=page.pages | divided_by: 444.0 | plus: 0.06 -%}
{% assign depth = thickness | append: "in" -%}
.center {
  padding: 0;
  border-top: grey thin dashed;
  {% if page.pages %}
  width: {{ thickness }}in;
  line-height: {{ thickness }}in;
  {% else %}
  width: {{page.thickness}};
  line-height: {{page.line_height | default: "2cm"}};
  {% endif %}
  background: {{ page.background | default: "#E21D3C" }};
}

.face img {
    /* border: blue solid thin; */
    width: 100%;
    height: 100%;
}

#front {
  box-sizing: border-box;
  border: lightgrey solid thin;
  border-left: none;
  background: {{ page.front.background | default: "white" }};  
}

#back {
  border: lightgrey solid thin;
  border-right: none;
{%- if page.back.img %}
  padding: 0;
{% else %}
  line-height: {{ page.back.line_height | default: "1.5em" }};
  font-family: "{{ page.back.family | default: "serif" }}";
  font-size: {{ page.back.size | default: "12pt" }};
  color: {{ page.back.color | default: "black" }};
  padding: 1in;
{% endif %}
  background: {{ page.back.background | default: "white" }};
}

.rules {
  /* border: white solid thin; */
  /* height: 2em; */
  font-family: sans-serif;
  font-weight: 100;
  margin-top: 1mm;
  margin-bottom: 1mm;
  /* box-sizing: border-box; */
}

.face-rule {
  box-sizing: border-box;
  border-left: solid red thin;
  border-right: solid red thin;
  text-align: center;
  /* height: 0.5cm; */
  width: {{ page.width }};
}

.center-rule {
  box-sizing: border-box;
  /* height: 0.5cm; */
  width: calc({{ thickness | divided_by: 2 }}in - 1px);
}

#siderule {
    display: block;
    /* box-sizing: border-box; */
    border-top: solid blue thin;
    border-bottom: solid blue thin;
    font-family: sans-serif;
    writing-mode: vertical-rl;
    font-weight: 100;
    text-align: center;
    width: 1em;
    margin-left: 2mm;
    height: {{page.height}};
}

.center td {
    display: block;  
}

td {
    padding: 0;
}

#head img, #foot img {
  max-height: calc({{page.head.height | default: depth}} - 2 * {{page.head.padding | default: "1mm"}});
  max-width: calc({{depth}} - 2 * {{page.head.padding | default: "1mm"}});
}

#head {
  box-sizing: border-box;
  width: {{ page.head.width | default: depth }};
  height: {{ page.head.height | default: depth }};
  background: {{ page.head.bg | default: "initial" }};
  writing-mode: {{ page.head.writing_mode | default: "initial" }};
  font-size: {{ page.head.font.size | default: "initial" }};
  font-family: "{{ page.head.font.family | default: "serif" }}";
  color: {{ page.head.color | default: "white" }};  
  border: {{page.head.border | default: "none" }};
  vertical-align: {{ page.head.vertical_align | default: "initial" }};
  text-align: {{ page.head.text_align | default: "initial" }};
  line-height: {{ page.head.line_height | default: "initial" }};
  padding: {{ page.head.padding | default: "1mm" }};
  margin: {{ page.head.margin | default: "0" }};
}

#top {
  box-sizing: border-box;
  width: {{ page.top.width | default: depth }};
  height: {%if page.top.height %}{{page.top.height}}{%else%}calc({{page.height}} - {{page.head.height | default: depth}} - {{page.bottom.height}} - {{page.foot.height}} - {{page.top.offset | default: "0mm"}}){%endif%};
  border: {{page.top.border | default: "none" }};
  background: {{ page.top.bg | default: "initial" }};
  writing-mode: {{ page.top.writing_mode | default: "initial" }};
  font-size: {{ page.top.font.size | default: "initial" }};
  font-family: "{{ page.top.font.family | default: "serif" }}";
  color: {{ page.top.color | default: "white" }};  
  border: {{page.top.border | default: "none" }};
  vertical-align: {{ page.top.vertical_align | default: "initial" }};
  text-align: {{ page.top.text_align | default: "initial" }};
  line-height: {%if page.top.line_height %}{{page.top.line_height}}{%else%}calc(({{depth}} - 2mm) / 2){%endif%};
  padding: {{ page.top.padding | default: "0" }};
  margin: {{ page.top.margin | default: "0" }};
}

#bottom {
  box-sizing: border-box;
  width: {{ page.bottom.width | default: depth }};
  height: {{ page.bottom.height | default: "auto" }};
  border: {{page.bottom.border | default: "none" }};
  background: {{ page.bottom.bg | default: "initial" }};
  writing-mode: {{ page.bottom.writing_mode | default: "initial" }};
  font-size: {{ page.bottom.font.size | default: "initial" }};
  font-family: "{{ page.bottom.font.family | default: "serif" }}";
  color: {{ page.bottom.color | default: "white" }};  
  border: {{page.bottom.border | default: "none" }};
  vertical-align: {{ page.bottom.vertical_align | default: "initial" }};
  text-align: {{ page.bottom.text_align | default: "initial" }};
  line-height: {{ page.bottom.line_height | default: "inherit" }};
  padding: {{ page.bottom.padding | default: "0" }};
  margin: {{ page.bottom.margin | default: "0" }};
}

#foot {
  box-sizing: border-box;
  width: {{ page.foot.width | default: depth }};
  height: {{ page.foot.height | default: "auto" }};
  border: {{page.foot.border | default: "none" }};
  background: {{ page.foot.bg | default: "initial" }};
  writing-mode: {{ page.foot.writing_mode | default: "initial" }};
  font-size: {{ page.foot.font.size | default: "initial" }};
  font-family: "{{ page.foot.font.family | default: "serif" }}";
  font-variant: {{ page.foot.font.variant | default: "initial" }};
  color: {{ page.foot.color | default: "white" }};  
  border: {{page.foot.border | default: "none" }};
  vertical-align: {{ page.foot.vertical_align | default: "initial" }};
  text-align: {{ page.foot.text_align | default: "initial" }};
  line-height: {{ page.foot.line_height | default: "initial" }};
  padding: {{ page.foot.padding | default: "0" }};
  margin: {{ page.foot.margin | default: "0" }};
}
</style>

<title>Cover {{page.title | strip_html}}</title>
</head>
<body>
<table><tbody>
<tr class="rules">
  <td class="face-rule" style="margin-bottom: 1mm; text-align: right;">→</td>
  <td class="center-rule" style="border-right: solid thin;">&nbsp;</td>
  <td class="center-rule" style="border-left: solid thin;">&nbsp;</td>
  <td class="face-rule" style="margin-bottom: 1mm; text-align: left; box-sizing: content-box;">
← {{thickness | round: 2 }}in
  </td>
</tr>
<tr id="covers">
  <td class="face" id="back">
    {%- if page.back.img %}
    <img src="..{{page.back.img}}" alt="">
    {% endif -%}
    {{content}}</td>
  <td colspan=2 class="center"><table><tbody>
    {% if page.head %}<tr><td id="head">
      {%- if page.head.img %}
      <img src="{{ page.head.img }}">
      {% endif -%}
      {{ page.head.text }}</td></tr>{% endif %}
    {% if page.top %}<tr><td id="top">{{ page.top.text | default: page.title }}</td></tr>{% endif %}
    {% if page.bottom %}<tr><td id="bottom">{{ page.bottom.text | default: page.author }}</td></tr>{% endif %}
    {% if page.foot %}<tr><td id="foot">{{ page.foot.text | default: page.publisher }}</td></tr>{% endif %}
  </tbody>
  </table>
  </td>
  <td class="face" id="front">
    {%- if page.front.img %}
    <img src="..{{page.front.img}}" alt="">
    {% else %}
    <div class="front-title">
        <h1>{{page.title}}</h1>
        <h2>{{page.author}}</h2>  
    </div>
    {% endif -%}
  </td>
  <td id="siderule">{{page.height}}</td>
</tr>
<tr class="rules">
  <td class="face-rule" style="margin-top: 1mm;">
    {{ page.width }}<br/>{{page.title}}
  </td>
  <td class="center-rule" style="border-right: solid thin; margin-top: 1mm;">&nbsp;</td>
  <td class="center-rule" style="border-left: solid thin;margin-top: 1mm;transform: translate(-4mm, 5mm); background: white;"></td>
  <td class="face-rule" style="margin-bottom: 1mm;box-sizing: content-box;">
    {{ page.width }}<br/>{{page.pages}} pages
  </td>
</tr>
</tbody>
</table>
</body>
</html>
